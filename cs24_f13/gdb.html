<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="/public/variant-multi.css" title="Variant Multi" media="all" />
    <link rel="stylesheet" type="text/css" href="/public/monokai.sublime.css" />
    <link href="data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQEAYAAABPYyMiAAAABmJLR0T///////8JWPfcAAAACXBIWXMAAABIAAAASABGyWs+AAAAF0lEQVRIx2NgGAWjYBSMglEwCkbBSAcACBAAAeaR9cIAAAAASUVORK5CYII=" rel="icon" type="image/x-icon" />
    <title>GDB &raquo; CS24 Fall 2013</title>
  </head>
  <body>
    <div id="container980">
<div id="header">
  <h1><a href="/cs24_f13/">Computer Science 24, Fall 2013</a></h1>
  <h2>Problem Solving with Computers II</h2>
</div>

<div id="menu">
  <ul>
    <li><a href="/cs24_f13/schedule">lecture schedule</a></li>
    <li><a href="/cs24_f13/submission">submission instructions</a></li>
    <li><a href="/cs24_f13/gdb">gdb tutorial</a></li>
  </ul>
</div>

<div id="main">
  <div id="sidebar">
    <div class="sidebarbox">
      <h2>People &amp; Office Hours</h2>
      <ul>
        <li><strong>Instructor</strong>: Bryce Boe
          (<a href="/">web</a>, <a href="mailto:bboe@cs.ucsb.edu">email</a>)
          <ul>
            <li>Tuesday, 15:30 - 16:30 in HFH 1152</li>
            <li>Wednesday, 11:00 - 12:00 in HFH 1152</li>
          </ul>
        </li>
        <li><strong>TA</strong>: Geoffrey Douglas
          <ul>
            <li>Wednesday, 15:00 - 17:00 in Phelps 1413</li>
          </ul>
        </li>
        <li><strong>TA</strong>: Jon Sun
          <ul>
            <li>Thursday, 10:00 - 12:00 in Phelps 1413</li>
          </ul>
        </li>
        <li><strong>TA</strong>: Dani Kudrow
          <ul>
            <li>Thursday, 15:00 - 17:00 in Phelps 1413</li>
          </ul>
        </li>
      </ul>
    </div>

    <div class="sidebarbox">
      <h2>Deadlines</h2>
      <h3>All deadlines are at 23:59:59 on the due date unless otherwise noted.</h3>
      <ul>
        <li>2013/09/30 -- <a href="/cs24_f13/lab1">Lab 1</a></li>
        <li>2013/10/02 -- Drop deadline (no fee)</li>
        <li>2013/10/08 -- <a href="/cs24_f13/lab2">Lab 2</a></li>
        <li>2013/10/14 -- <a href="/cs24_f13/lab3">Lab 3</a></li>
        <li>2013/10/20 -- <a href="/cs24_f13/proj1">Project 1</a></li>
        <li>2013/10/22 -- <a href="/cs24_f13/lab4">Lab 4</a></li>
        <li>2013/10/23 23:45 -- Drop deadline ($3 fee)</li>
        <li>2013/10/28 -- <a href="/cs24_f13/lab5">Lab 5</a></li>
        <li>2013/10/30 14:00 -- Midterm Examination</li>
        <li>2013/11/04 -- <a href="/cs24_f13/lab6">Lab 6</a></li>
        <li>2013/11/13 -- <a href="/cs24_f13/lab7">Lab 7</a></li>
        <li>2013/11/18 -- <a href="/cs24_f13/lab8">Lab 8</a></li>
        <li>2013/11/22 -- <a href="/cs24_f13/proj2">Project 2</a></li>
        <li>2013/11/25 -- <a href="/cs24_f13/lab9">Lab 9</a></li>
        <li>2013/12/02 -- <a href="/cs24_f13/lab10">Lab 10</a></li>
        <li>2013/12/06 -- <a href="/cs24_f13/proj3">Project 3</a></li>
        <li>2013/12/09 16:00 -- Final Examination</li>
      </ul>
    </div>
  </div>

  <div id="content">
<h1 id="the-gnu-debugger">The GNU Debugger</h1>

<hr />

<h2 id="command-quick-reference">Command quick reference</h2>

<ul>
  <li><strong>run</strong> [arg1 arg2 …] - execute program with command line arguments</li>
  <li><strong>list</strong> - print source code</li>
  <li><strong>print</strong> [var] - print value of variable</li>
  <li>
    <table>
      <tbody>
        <tr>
          <td><strong>break</strong> [line number</td>
          <td>function] - set breakpoint at <em>line number</em> or <em>function</em></td>
        </tr>
      </tbody>
    </table>
  </li>
  <li><strong>info break</strong>- list all breakpoints</li>
  <li><strong>delete</strong> [n] - delete breakpoint n</li>
  <li><strong>continue</strong> - resume execution after breakpoint</li>
  <li><strong>next</strong> - execute next line and pause</li>
  <li><strong>step</strong> - descend into function call an pause</li>
  <li><strong>backtrace</strong> - show function call stack</li>
</ul>

<hr />

<h2 id="what-is-gdb">What is gdb?</h2>

<p>The GNU Debugger is a program that you can use to examine your code while it is
running. It allows you to do things like pause execution of the program,
inspect variables, and view the stack. The debugger is extremely useful in
tracking down bugs because it provides you with a lot of information about the
running state of your program.</p>

<h2 id="starting-gdb">Starting gdb</h2>

<p>Before we can use gdb, it requires some extra information from the
compiler. We’ll use the timeless <em>hello.c</em> program as our example code:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span>
<span class="kt">void</span> <span class="nf">hello</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">a</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s">"I'm a segfault!"</span><span class="p">;</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"Hello world!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">hello</span><span class="p">();</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>We must compile our program with the <code class="language-plaintext highlighter-rouge">-g</code> flag to include debugging
information in the executable:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ clang -g hello.c # compile hello.c with debugging information
</code></pre></div></div>

<p>To start the debugger, we simply use the <code class="language-plaintext highlighter-rouge">gdb</code> command followed by the name of
the executable:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ gdb a.out # run the debugger on a.out
</code></pre></div></div>

<p>The gdb prompt is <code class="language-plaintext highlighter-rouge">(gdb)</code>. We can enter commands after this prompt to control
execution of our program. To run the executable in gdb we use the <code class="language-plaintext highlighter-rouge">run</code> command
followed by any command line arguments the program takes:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(gdb) run arg1 arg2 # run a.out with the arguments "arg1" and "arg2"
</code></pre></div></div>

<h2 id="backtrace">Backtrace</h2>

<p>We can use the <code class="language-plaintext highlighter-rouge">backtrace</code> command at any time to see which functions are on the
stack. This is particularly useful after the program has been interrupted (for
example by a segmentation fault or a <code class="language-plaintext highlighter-rouge">^C</code> interrupt); we can see exactly where
the error occurred:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Program received signal SIGSEGV, Segmentation fault.
0x000000000040053e in hello () at hello.c:5
5               a[1] = "I'm a segfault!";
(gdb) backtrace # print the function stack
#0  0x000000000040053e in hello () at hello.c:5
#1  0x0000000000400574 in main () at hello.c:10
(gdb)
</code></pre></div></div>

<p>Here we see that the segmentation fault occurred while executing line 5 of
hello.c. The backtrace shows us that it occurred in the function <code class="language-plaintext highlighter-rouge">hello()</code>
which was called by <code class="language-plaintext highlighter-rouge">main()</code>.</p>

<h2 id="breakpoints">Breakpoints</h2>

<p>One of the most useful features of gdb is the ability to stop our code at
specific points called breakpoints. Breakpoints are set with the <code class="language-plaintext highlighter-rouge">break</code>
command. We can break at a line number:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(gdb) break hello.c:4  # program will pause at line 4 of hello.c
</code></pre></div></div>

<p>or at a function call:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(gdb) break hello.c:hello  # program will pause before executing hello()
</code></pre></div></div>

<p>We can view the breakpoints that are set using <code class="language-plaintext highlighter-rouge">info break</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(gdb) info break # list all breakpoints
Num     Type           Disp Enb Address    What
1       breakpoint     keep y   0x080483da in hello at hello.c:4
2       breakpoint     keep y   0x080483ee in main at hello.c:9
(gdb)
</code></pre></div></div>

<p>Breakpoints must be referenced by their number. To delete the break at line 4:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(gdb) delete 1 # delete breakpoint 1
</code></pre></div></div>

<p>We can resume the program using the <code class="language-plaintext highlighter-rouge">continue</code> command:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(gdb) continue # resume execution
</code></pre></div></div>

<p>Alternatively we can walk through the code using <code class="language-plaintext highlighter-rouge">next</code> and <code class="language-plaintext highlighter-rouge">step</code>. <code class="language-plaintext highlighter-rouge">next</code> will
execute the next line of code, stepping <em>over</em> any function calls and then stop:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Breakpoint 1, main () at hello.c:9
9               hello();
(gdb) next # execute line 9 of hello.c and then pause at line 10
Hello world!
10              return 0;
(gdb)
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">step</code> command will step <em>into</em> any function calls. We can use it to walk
through the function being called:</p>

<p>Breakpoint 1, main () at hello.c:9
9               hello();
(gdb) step # pause at the first line of the function hello()
hello () at hello.c:4
4               printf(“Hello world!\n”);
(gdb)</p>

<h2 id="inspecting-variables">Inspecting variables</h2>

<p>We can examine the values of variables in our program during executing with
the “print” command:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Breakpoint 1, hello () at hello.c:4
4               char *a = NULL;
(gdb) print a # print the current value of a
$1 = 0x0
(gdb)
</code></pre></div></div>

<p>Here we see that <code class="language-plaintext highlighter-rouge">a</code> is <code class="language-plaintext highlighter-rouge">NULL</code> (so we get a segmentation fault when we try to
dereference it!)</p>

<h2 id="other-useful-commands">Other useful commands</h2>

<p>The “list” command allows you to view the source code of the program
executing.</p>

<p>The “help” command gives detailed instructions on how to use different gdb
commands.</p>

<p>Almost all of the commands in gdb can be abbreviated. For instance <code class="language-plaintext highlighter-rouge">r</code> is
equivalent to <code class="language-plaintext highlighter-rouge">run</code>, <code class="language-plaintext highlighter-rouge">bt</code> is equivalent to <code class="language-plaintext highlighter-rouge">backtrace</code> and so on. Use the help
command to see acceptable abbreviations.</p>

  </div>
  <div class="clear">&nbsp;</div>
</div>

      <div id="credits">
        <p><span class="small">Template design by <a href="https://andreasviklund.com/">Andreas Viklund</a></span></p>
      </div>
    </div>
  </body>
</html>
